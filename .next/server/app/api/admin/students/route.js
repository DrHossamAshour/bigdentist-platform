"use strict";(()=>{var e={};e.id=5078,e.ids=[5078],e.modules={53524:e=>{e.exports=require("@prisma/client")},98432:e=>{e.exports=require("bcryptjs")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},12781:e=>{e.exports=require("stream")},73837:e=>{e.exports=require("util")},39501:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>h,originalPathname:()=>x,patchFetch:()=>y,requestAsyncStorage:()=>p,routeModule:()=>l,serverHooks:()=>f,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>v});var s={};t.r(s),t.d(s,{GET:()=>d});var n=t(95419),a=t(69108),i=t(99678),o=t(78070),u=t(3214),c=t(3205);async function d(e){try{let r=e.cookies.get("auth-token")?.value;if(!r)return o.Z.json({error:"Authentication required"},{status:401});let t=(0,c.WX)(r);if(!t)return o.Z.json({error:"Invalid token"},{status:401});if(!["ADMIN","SUPER_ADMIN"].includes(t.role))return o.Z.json({error:"Access denied"},{status:403});let s=await u._.user.findMany({include:{enrollments:{select:{id:!0,course:{select:{title:!0}}}}},orderBy:{createdAt:"desc"}});return o.Z.json(s)}catch(e){return console.error("Error fetching users:",e),o.Z.json({error:"Internal server error"},{status:500})}}let l=new n.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/admin/students/route",pathname:"/api/admin/students",filename:"route",bundlePath:"app/api/admin/students/route"},resolvedPagePath:"E:\\BigDentist Website\\app\\api\\admin\\students\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:p,staticGenerationAsyncStorage:m,serverHooks:f,headerHooks:h,staticGenerationBailout:v}=l,x="/api/admin/students/route";function y(){return(0,i.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:m})}},3205:(e,r,t)=>{t.d(r,{RA:()=>c,So:()=>l,WX:()=>d});var s=t(98432),n=t.n(s),a=t(46082),i=t.n(a),o=t(3214);let u=async(e,r)=>await n().compare(e,r),c=e=>i().sign(e,process.env.JWT_SECRET||"fallback-secret",{expiresIn:"7d"}),d=e=>{try{return i().verify(e,process.env.JWT_SECRET||"fallback-secret")}catch(e){return null}},l=async(e,r)=>{let t=await o._.user.findUnique({where:{email:e}});return t&&await u(r,t.password)?t:null}},3214:(e,r,t)=>{t.d(r,{_:()=>n});var s=t(53524);let n=globalThis.prisma??new s.PrismaClient}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[1638,6206,6082],()=>t(39501));module.exports=s})();