"use strict";(()=>{var e={};e.id=8062,e.ids=[8062],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},96287:(e,t,i)=>{i.r(t),i.d(t,{headerHooks:()=>v,originalPathname:()=>h,patchFetch:()=>g,requestAsyncStorage:()=>m,routeModule:()=>l,serverHooks:()=>p,staticGenerationAsyncStorage:()=>c,staticGenerationBailout:()=>f});var o={};i.r(o),i.d(o,{POST:()=>u});var r=i(95419),a=i(69108),s=i(99678),n=i(78070),d=i(7042);async function u(e){try{if(!process.env.VIMEO_ACCESS_TOKEN)return n.Z.json({error:"Vimeo access token not configured. Please add VIMEO_ACCESS_TOKEN to your environment variables."},{status:400});let e=await fetch("https://api.vimeo.com/me/videos?per_page=100&fields=uri,name,description,duration,pictures,stats,privacy,created_time,modified_time",{headers:{Authorization:`Bearer ${process.env.VIMEO_ACCESS_TOKEN}`,"Content-Type":"application/json"}});if(!e.ok)return console.error("Vimeo API error:",e.status,e.statusText),n.Z.json({error:`Failed to fetch videos from Vimeo: ${e.status} ${e.statusText}`},{status:e.status});let t=await e.json(),i=(t.data||[]).map(e=>{let t=e.uri.split("/").pop();return{id:t,title:e.name||"Untitled Video",description:e.description||"",duration:e.duration||0,durationFormatted:d.b.formatDuration(e.duration||0),thumbnail:e.pictures?.base_link?`${e.pictures.base_link}_1280x720.jpg`:d.b.getThumbnailUrl(t,"medium"),embedUrl:d.b.getEmbedUrl(t),privacy:e.privacy?.view||"unknown",stats:{plays:e.stats?.plays||0,likes:e.stats?.likes||0},createdTime:e.created_time,modifiedTime:e.modified_time,usage:{type:"vimeo_account",items:[]}}});i.sort((e,t)=>e.modifiedTime?t.modifiedTime?new Date(t.modifiedTime).getTime()-new Date(e.modifiedTime).getTime():-1:1);let o={totalVideos:i.length,totalDuration:i.reduce((e,t)=>e+t.duration,0),totalPlays:i.reduce((e,t)=>e+t.stats.plays,0),totalLikes:i.reduce((e,t)=>e+t.stats.likes,0)};return n.Z.json({success:!0,message:`Successfully synced ${i.length} videos from Vimeo`,videos:i,summary:o,pagination:t.paging||null})}catch(e){return console.error("Error syncing Vimeo videos:",e),n.Z.json({error:"Failed to sync videos from Vimeo. Please check your API token and try again."},{status:500})}}let l=new r.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/admin/vimeo/sync/route",pathname:"/api/admin/vimeo/sync",filename:"route",bundlePath:"app/api/admin/vimeo/sync/route"},resolvedPagePath:"E:\\BigDentist Website\\app\\api\\admin\\vimeo\\sync\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:m,staticGenerationAsyncStorage:c,serverHooks:p,headerHooks:v,staticGenerationBailout:f}=l,h="/api/admin/vimeo/sync/route";function g(){return(0,s.patchFetch)({serverHooks:p,staticGenerationAsyncStorage:c})}},7042:(e,t,i)=>{i.d(t,{b:()=>r});class o{constructor(){this.accessToken=process.env.VIMEO_ACCESS_TOKEN||""}extractVideoId(e){for(let t of[/vimeo\.com\/(\d+)/,/vimeo\.com\/video\/(\d+)/,/player\.vimeo\.com\/video\/(\d+)/]){let i=e.match(t);if(i)return i[1]}return null}isValidVimeoUrl(e){return null!==this.extractVideoId(e)}async getVideoInfo(e){if(!this.accessToken)return console.warn("Vimeo access token not configured"),null;try{let t=await fetch(`https://api.vimeo.com/videos/${e}`,{headers:{Authorization:`Bearer ${this.accessToken}`,"Content-Type":"application/json"}});if(!t.ok){if(404===t.status)throw Error("Video not found or is private");throw Error(`Vimeo API error: ${t.status}`)}return await t.json()}catch(e){return console.error("Error fetching Vimeo video info:",e),null}}async validateVideoUrl(e){if(!this.isValidVimeoUrl(e))return{isValid:!1,error:"Invalid Vimeo URL format"};let t=this.extractVideoId(e);if(!t)return{isValid:!1,error:"Could not extract video ID from URL"};let i=await this.getVideoInfo(t);return i?"nobody"===i.privacy.view?{isValid:!1,error:"Video is private and cannot be embedded"}:{isValid:!0,video:i}:{isValid:!1,error:"Video not found or is private"}}getEmbedUrl(e,t={}){let i=new URLSearchParams;t.autoplay&&i.append("autoplay","1"),t.muted&&i.append("muted","1"),!1!==t.controls&&i.append("controls","1"),!1!==t.responsive&&i.append("responsive","1");let o=i.toString();return`https://player.vimeo.com/video/${e}${o?`?${o}`:""}`}formatDuration(e){let t=Math.floor(e/3600),i=Math.floor(e%3600/60),o=e%60;return t>0?`${t}:${i.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`:`${i}:${o.toString().padStart(2,"0")}`}getThumbnailUrl(e,t="medium"){return`https://vumbnail.com/${e}_${({small:"640x360",medium:"1280x720",large:"1920x1080"})[t]}.jpg`}}let r=new o}};var t=require("../../../../../webpack-runtime.js");t.C(e);var i=e=>t(t.s=e),o=t.X(0,[1638,6206],()=>i(96287));module.exports=o})();